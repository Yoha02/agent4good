

def main():
    """Main function to fetch all external data and load into BigQuery"""
    logger.info("Starting external data ingestion...")
    
    # Fetch and insert wildfire data
    wildfire_fetcher = WildfireDataFetcher()
    wildfire_data = wildfire_fetcher.fetch_data()
    wildfire_fetcher.insert_to_bigquery(wildfire_data)
    
    # Fetch and insert earthquake data
    earthquake_fetcher = EarthquakeDataFetcher()
    earthquake_data = earthquake_fetcher.fetch_data()
    earthquake_fetcher.insert_to_bigquery(earthquake_data)
    
    # Fetch and insert storm reports
    storm_fetcher = StormReportsFetcher()
    storm_data = storm_fetcher.fetch_data()
    storm_fetcher.insert_to_bigquery(storm_data)
    
    # Fetch and insert NY health data
    ny_health_fetcher = NYHealthDataFetcher()
    ny_health_data = ny_health_fetcher.fetch_data()
    ny_health_fetcher.insert_to_bigquery(ny_health_data)
    
    # Fetch and insert CDC COVID data
    cdc_covid_fetcher = CDCCovidDataFetcher()
    cdc_covid_data = cdc_covid_fetcher.fetch_data()
    cdc_covid_fetcher.insert_to_bigquery(cdc_covid_data)
    
    logger.info("External data ingestion complete!")


if __name__ == "__main__":
    main()
